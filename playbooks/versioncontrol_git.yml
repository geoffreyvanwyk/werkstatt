---
- name: Version Control with Git
  hosts: all

  tasks:
    - name: Add aliases for Git
      vars:
        bash_aliases_to_add:
          g: git
          ga: git add
          gb: git branch
          gc: git commit
          gcl: git clone
          gco: git checkout
          gf: git fetch
          gi: git init
          gm: git merge
          gp: git push
          gpl: git pull
          gr: git remote
          gs: git status
      ansible.builtin.include_tasks: ../tasks/bash_add_aliases.yml

    - name: LazyGit - Simple terminal UI for Git commands
      vars:
        lazygit_version: 0.41.0
      block:
        - name: Create directory for LazyGit
          become: true
          ansible.builtin.file:
            path: /opt/lazygit/lazygit_{{ lazygit_version }}
            state: directory
            owner: "{{ ansible_user }}"
            group: "{{ ansible_user }}"
            mode: u=rwX,go=rX

        - name: Download LazyGit archive
          ansible.builtin.get_url:
            url: https://github.com/jesseduffield/lazygit/releases/download/v{{ lazygit_version }}/lazygit_{{ lazygit_version }}_Linux_x86_64.tar.gz
            dest: /opt/lazygit/lazygit_{{ lazygit_version }}_Linux_x86_64.tar.gz
            mode: u=rw,go=r

        - name: Extract LazyGit archive
          ansible.builtin.unarchive:
            src: /opt/lazygit/lazygit_{{ lazygit_version }}_Linux_x86_64.tar.gz
            remote_src: true
            dest: /opt/lazygit/lazygit_{{ lazygit_version }}

        - name: Install LazyGit
          become: true
          ansible.builtin.command:
            chdir: /opt/lazygit/lazygit_{{ lazygit_version }}
            cmd: install lazygit /usr/local/bin
            creates: /usr/local/bin/lazygit
